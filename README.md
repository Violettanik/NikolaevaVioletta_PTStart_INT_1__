Мини Отчёт

ПЕРЕД ЗАПУСКОМ ТЕСТОВ НЕОБХОДИМО ДОБАВИТЬ В ДИРЕКТОРИЮ ПРОЕКТА ФАЙЛ .ENV, СОДЕРЖАЩИЙ ПЕРЕМЕННЫЕ DB_USER, DB_PASSWORD, DB_HOST, DB_DATABASE.

Я создала программную реализацию тестирования SELECT str like pattern на базе MySQL. Проект написан на Python3 с использованием pytest.
Программа выполняет следующие действия:
1) подключается к пользователю MySQL;
2) создаёт базу данных, если её не существует;
3) создаёт таблицу кандидатов на прохождение стажировки, если её не существует, таблица содержит колонки имени, даты рождения, пола, образования;
5) генерирует из набора 9 типов кандидатов определённое количество строк, которые необходимо вставить в таблицу для тестирования SELECT str like pattern, и вставляет эти строки в таблицу;
6) производит функциональные тесты, цель которых убедиться в том, что результаты работы запросов на одинаковых данных не отличаются, когда на колонке нет индекса и когда он есть;
7) производит перфоманс тесты, цель которых убедиться в том, что запросы с использованием индексов работают быстрее, чем без них.

Для функциональных тестов не требуется большое количество данных, но для успешного проведения перфоманс тестов необходимо большое количество строк базы данных. Оптимальной вариант - 10000 строк и больше.

Примечание для использования индексов: если с помощью SELECT str like pattern необходимо найти более 20% всех строк, то MySQL игнорирует наличие индекса и проводит полное сканирование базы данных. Этот факт не влияет на успешность выполнения функциональных тестов, но в случае необходимости найти более 20% всех строк эти тесты становятся бессмысленными, так как при наличии индекса и при его отсутсвии происходит полное сканирование, и очевидно, что результаты будут одинаковые. Но необходимость найти более 20% всех строк сильно влияет на перфоманс тесты, так как результаты сравнения времени поиска будут рандомными: в обоих случая происходит полное сканирование, какое из них будет быстрее зависит от внешних факторов, не связанных с индексом. Поэтому с вероятностью 50% перфоманс тесты проваливаются. В проекте не используются pattern-ы, которые могут вызвать такую ситуацию, и тесты проходят успешно.

Примечание для функциональных тестов: результаты работы запросов на одинаковых данных могут отличаться, когда на колонке нет индекса и когда он есть, в том случае если pattern подходит для нескольких различных вариантов колонки str. Например, pattern "%Moscow%" подходит "Moscow State University Faculty of Law", "Faculty of Design of Moscow State University", "Computer Science and Control Systems of Bauman Moscow State Technical University", "Faculty of Graphics of the Stroganov Moscow State Academy of Art and Industry". Если на колонку education установлен индекс, и поиск проходит с его использованием  (выше было описано, когда MySQL игнорирует наличие индекса), то результат будет отсортирован по значениям колонки education. Если индекс не используется, то результат будет содержать подходящие строки в том порядке, в каком они расположены в базе. Поэтому результаты могут отличаться. В проекте не используются pattern-ы, которые могут вызвать такую ситуацию, и тесты проходят успешно.

Примечание для перфоманс тестов: бывают ситуации, когда на время выполнения SELECT str like pattern влияют некоторые внешние факторы, не связанные с наличием индекса. Поэтому в перфоманс тестах производится по 10 одинаковым запросам без индекса и 10 с ним. Если в как минимум 6 случаях из 10 время поиска с индеком меньше времени поиска без него, то тест считается успешно пройденым.

Если тесты было пройдены неуспешно, то, пожалуйста, попробуйте удалить созданную базу данных и запустить программу снова (возможно какой-то из типов кандидатов заполнил более 20% всей базы данных).
